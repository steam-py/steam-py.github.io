{"version":3,"file":"scripts/lutra.js","mappings":"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","sources":["webpack:///./node_modules/debounce-animation-frame/dist/debounceAnimationFrame.js","webpack:///./node_modules/debounce-animation-frame/dist/index.js","webpack:///./node_modules/instant.page/instantpage.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///./src/lutra/assets/scripts/lutra.ts","webpack:///./src/lutra/assets/scripts/scrollspy.ts"],"sourcesContent":["Object.defineProperty(exports, \"__esModule\", { value: true });\r\nconst debounceAnimationFrame = (fn) => {\r\n    let timeout;\r\n    const debouncedFn = (...args) => {\r\n        cancelAnimationFrame(timeout);\r\n        return new Promise(resolve => {\r\n            timeout = requestAnimationFrame(() => {\r\n                const result = fn(...args);\r\n                resolve(result);\r\n            });\r\n        });\r\n    };\r\n    return debouncedFn;\r\n};\r\nexports.default = debounceAnimationFrame;\r\n","var __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst debounceAnimationFrame_1 = __importDefault(require(\"./debounceAnimationFrame\"));\r\nexports.default = debounceAnimationFrame_1.default;\r\n","/*! instant.page v5.1.1 - (C) 2019-2020 Alexandre Dieulot - https://instant.page/license */\n\nlet mouseoverTimer\nlet lastTouchTimestamp\nconst prefetches = new Set()\nconst prefetchElement = document.createElement('link')\nconst isSupported = prefetchElement.relList && prefetchElement.relList.supports && prefetchElement.relList.supports('prefetch')\n                    && window.IntersectionObserver && 'isIntersecting' in IntersectionObserverEntry.prototype\nconst allowQueryString = 'instantAllowQueryString' in document.body.dataset\nconst allowExternalLinks = 'instantAllowExternalLinks' in document.body.dataset\nconst useWhitelist = 'instantWhitelist' in document.body.dataset\nconst mousedownShortcut = 'instantMousedownShortcut' in document.body.dataset\nconst DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION = 1111\n\nlet delayOnHover = 65\nlet useMousedown = false\nlet useMousedownOnly = false\nlet useViewport = false\n\nif ('instantIntensity' in document.body.dataset) {\n  const intensity = document.body.dataset.instantIntensity\n\n  if (intensity.substr(0, 'mousedown'.length) == 'mousedown') {\n    useMousedown = true\n    if (intensity == 'mousedown-only') {\n      useMousedownOnly = true\n    }\n  }\n  else if (intensity.substr(0, 'viewport'.length) == 'viewport') {\n    if (!(navigator.connection && (navigator.connection.saveData || (navigator.connection.effectiveType && navigator.connection.effectiveType.includes('2g'))))) {\n      if (intensity == \"viewport\") {\n        /* Biggest iPhone resolution (which we want): 414 × 896 = 370944\n         * Small 7\" tablet resolution (which we don’t want): 600 × 1024 = 614400\n         * Note that the viewport (which we check here) is smaller than the resolution due to the UI’s chrome */\n        if (document.documentElement.clientWidth * document.documentElement.clientHeight < 450000) {\n          useViewport = true\n        }\n      }\n      else if (intensity == \"viewport-all\") {\n        useViewport = true\n      }\n    }\n  }\n  else {\n    const milliseconds = parseInt(intensity)\n    if (!isNaN(milliseconds)) {\n      delayOnHover = milliseconds\n    }\n  }\n}\n\nif (isSupported) {\n  const eventListenersOptions = {\n    capture: true,\n    passive: true,\n  }\n\n  if (!useMousedownOnly) {\n    document.addEventListener('touchstart', touchstartListener, eventListenersOptions)\n  }\n\n  if (!useMousedown) {\n    document.addEventListener('mouseover', mouseoverListener, eventListenersOptions)\n  }\n  else if (!mousedownShortcut) {\n      document.addEventListener('mousedown', mousedownListener, eventListenersOptions)\n  }\n\n  if (mousedownShortcut) {\n    document.addEventListener('mousedown', mousedownShortcutListener, eventListenersOptions)\n  }\n\n  if (useViewport) {\n    let triggeringFunction\n    if (window.requestIdleCallback) {\n      triggeringFunction = (callback) => {\n        requestIdleCallback(callback, {\n          timeout: 1500,\n        })\n      }\n    }\n    else {\n      triggeringFunction = (callback) => {\n        callback()\n      }\n    }\n\n    triggeringFunction(() => {\n      const intersectionObserver = new IntersectionObserver((entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            const linkElement = entry.target\n            intersectionObserver.unobserve(linkElement)\n            preload(linkElement.href)\n          }\n        })\n      })\n\n      document.querySelectorAll('a').forEach((linkElement) => {\n        if (isPreloadable(linkElement)) {\n          intersectionObserver.observe(linkElement)\n        }\n      })\n    })\n  }\n}\n\nfunction touchstartListener(event) {\n  /* Chrome on Android calls mouseover before touchcancel so `lastTouchTimestamp`\n   * must be assigned on touchstart to be measured on mouseover. */\n  lastTouchTimestamp = performance.now()\n\n  const linkElement = event.target.closest('a')\n\n  if (!isPreloadable(linkElement)) {\n    return\n  }\n\n  preload(linkElement.href)\n}\n\nfunction mouseoverListener(event) {\n  if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) {\n    return\n  }\n\n  if (!('closest' in event.target)) {\n    // Without this check sometimes an error “event.target.closest is not a function” is thrown, for unknown reasons\n    // That error denotes that `event.target` isn’t undefined. My best guess is that it’s the Document.\n\n    // Details could be gleaned from throwing such an error:\n    //throw new TypeError(`instant.page non-element event target: timeStamp=${~~event.timeStamp}, type=${event.type}, typeof=${typeof event.target}, nodeType=${event.target.nodeType}, nodeName=${event.target.nodeName}, viewport=${innerWidth}x${innerHeight}, coords=${event.clientX}x${event.clientY}, scroll=${scrollX}x${scrollY}`)\n\n    return\n  }\n  const linkElement = event.target.closest('a')\n\n  if (!isPreloadable(linkElement)) {\n    return\n  }\n\n  linkElement.addEventListener('mouseout', mouseoutListener, {passive: true})\n\n  mouseoverTimer = setTimeout(() => {\n    preload(linkElement.href)\n    mouseoverTimer = undefined\n  }, delayOnHover)\n}\n\nfunction mousedownListener(event) {\n  const linkElement = event.target.closest('a')\n\n  if (!isPreloadable(linkElement)) {\n    return\n  }\n\n  preload(linkElement.href)\n}\n\nfunction mouseoutListener(event) {\n  if (event.relatedTarget && event.target.closest('a') == event.relatedTarget.closest('a')) {\n    return\n  }\n\n  if (mouseoverTimer) {\n    clearTimeout(mouseoverTimer)\n    mouseoverTimer = undefined\n  }\n}\n\nfunction mousedownShortcutListener(event) {\n  if (performance.now() - lastTouchTimestamp < DELAY_TO_NOT_BE_CONSIDERED_A_TOUCH_INITIATED_ACTION) {\n    return\n  }\n\n  const linkElement = event.target.closest('a')\n\n  if (event.which > 1 || event.metaKey || event.ctrlKey) {\n    return\n  }\n\n  if (!linkElement) {\n    return\n  }\n\n  linkElement.addEventListener('click', function (event) {\n    if (event.detail == 1337) {\n      return\n    }\n\n    event.preventDefault()\n  }, {capture: true, passive: false, once: true})\n\n  const customEvent = new MouseEvent('click', {view: window, bubbles: true, cancelable: false, detail: 1337})\n  linkElement.dispatchEvent(customEvent)\n}\n\nfunction isPreloadable(linkElement) {\n  if (!linkElement || !linkElement.href) {\n    return\n  }\n\n  if (useWhitelist && !('instant' in linkElement.dataset)) {\n    return\n  }\n\n  if (!allowExternalLinks && linkElement.origin != location.origin && !('instant' in linkElement.dataset)) {\n    return\n  }\n\n  if (!['http:', 'https:'].includes(linkElement.protocol)) {\n    return\n  }\n\n  if (linkElement.protocol == 'http:' && location.protocol == 'https:') {\n    return\n  }\n\n  if (!allowQueryString && linkElement.search && !('instant' in linkElement.dataset)) {\n    return\n  }\n\n  if (linkElement.hash && linkElement.pathname + linkElement.search == location.pathname + location.search) {\n    return\n  }\n\n  if ('noInstant' in linkElement.dataset) {\n    return\n  }\n\n  return true\n}\n\nfunction preload(url) {\n  if (prefetches.has(url)) {\n    return\n  }\n\n  const prefetcher = document.createElement('link')\n  prefetcher.rel = 'prefetch'\n  prefetcher.href = url\n  document.head.appendChild(prefetcher)\n\n  prefetches.add(url)\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import \"instant.page\";\nimport { ScrollObserver } from \"./scrollspy\";\n////////////////////////////////////////////////////////////////////////////////\n// Scroll Handling\n////////////////////////////////////////////////////////////////////////////////\nfunction setupScrollHandler() {\n    if (document.getElementById(\"lutra-main-content\") === null) {\n        console.debug(\"No main content, skipping scroll handler.\");\n        return;\n    }\n    const observer = new ScrollObserver();\n    observer.observe();\n}\n////////////////////////////////////////////////////////////////////////////////\n// Theme Toggle\n////////////////////////////////////////////////////////////////////////////////\nvar Theme;\n(function (Theme) {\n    Theme[\"LIGHT\"] = \"light\";\n    Theme[\"DARK\"] = \"dark\";\n    Theme[\"AUTO\"] = \"auto\";\n})(Theme || (Theme = {}));\nfunction setTheme(mode, class_to_set) {\n    // TODO: Tooltips.\n    // Sanitize the incoming values.\n    if (!Object.values(Theme).includes(mode)) {\n        console.error(`Got invalid theme mode: ${mode}. Resetting to auto.`);\n        mode = Theme.AUTO;\n    }\n    if (![Theme.LIGHT, Theme.DARK].includes(class_to_set)) {\n        console.error(`Got invalid theme class: ${class_to_set}. Resetting to light.`);\n        class_to_set = Theme.LIGHT;\n    }\n    document.body.dataset.theme = mode;\n    localStorage.setItem(\"theme\", mode);\n    if (class_to_set == Theme.LIGHT) {\n        document.documentElement.classList.remove(\"dark\");\n    }\n    else {\n        document.documentElement.classList.add(\"dark\");\n    }\n    console.debug(`Changed to ${mode} mode (${class_to_set}).`);\n}\nfunction cycleThemeOnce() {\n    const currentTheme = localStorage.getItem(\"theme\") || \"auto\";\n    const prefersDark = window.matchMedia(\"(prefers-color-scheme: dark)\").matches;\n    if (prefersDark) {\n        // Auto (dark) -> Light -> Dark\n        if (currentTheme === \"auto\") {\n            setTheme(Theme.LIGHT, Theme.LIGHT);\n        }\n        else if (currentTheme == Theme.LIGHT) {\n            setTheme(Theme.DARK, Theme.DARK);\n        }\n        else {\n            setTheme(Theme.AUTO, Theme.DARK);\n        }\n    }\n    else {\n        // Auto (light) -> Dark -> Light\n        if (currentTheme === Theme.AUTO) {\n            setTheme(Theme.DARK, Theme.DARK);\n        }\n        else if (currentTheme == Theme.DARK) {\n            setTheme(Theme.LIGHT, Theme.LIGHT);\n        }\n        else {\n            setTheme(Theme.AUTO, Theme.LIGHT);\n        }\n    }\n}\nfunction setupTheme() {\n    // Attach event handlers for toggling themes.\n    const buttons = document.getElementsByClassName(\"theme-toggle\");\n    Array.from(buttons).forEach((btn) => {\n        btn.addEventListener(\"click\", cycleThemeOnce);\n    });\n    // Watch for theme changes and update accordingly.\n    window\n        .matchMedia(\"(prefers-color-scheme: dark)\")\n        .addEventListener(\"change\", (e) => {\n        const _currentTheme = localStorage.getItem(\"theme\") || \"auto\";\n        const currentTheme = _currentTheme;\n        if (currentTheme === Theme.AUTO) {\n            setTheme(Theme.AUTO, e.matches ? Theme.DARK : Theme.LIGHT);\n        }\n        else {\n            // This is necessary to update the tooltips.\n            setTheme(currentTheme, currentTheme);\n        }\n    });\n}\nfunction setupHeaderSearch() {\n    const search_link = document.getElementById(\"lutra-header-search-link\");\n    if (search_link === null) {\n        console.debug(\"No search link, skipping header search.\");\n        return;\n    }\n    const search_container = document.getElementById(\"lutra-header-search-form\");\n    const search_overlay = document.getElementById(\"lutra-header-search-overlay\");\n    function searchDeactivate() {\n        search_container.classList.remove(\"active\");\n        search_overlay.removeEventListener(\"click\", searchDeactivate);\n    }\n    function searchDeactivateOnEscape(e) {\n        if (e.key === \"Escape\") {\n            searchDeactivate();\n            window.removeEventListener(\"keydown\", searchDeactivateOnEscape, true);\n        }\n    }\n    search_overlay.addEventListener(\"click\", searchDeactivate);\n    search_link.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        search_container.classList.add(\"active\");\n        const search_form = search_container.children[0];\n        search_form.q.focus();\n        window.addEventListener(\"keydown\", searchDeactivateOnEscape, true);\n    });\n}\n////////////////////////////////////////////////////////////////////////////////\n// Sidebar collapse\n////////////////////////////////////////////////////////////////////////////////\nfunction setupSidebarCollapse() {\n    const button = document.getElementById(\"lutra-site-navigation-collapse-icon\");\n    if (button === null) {\n        console.debug(\"No sidebar collapse button, skipping sidebar collapse.\");\n        return;\n    }\n    const container = document.getElementById(\"lutra-primary-sidebar-container\");\n    if (document.body.classList.contains(\"collapsed-site-navigation\")) {\n        container.setAttribute(\"aria-hidden\", \"true\");\n    }\n    button.addEventListener(\"click\", () => {\n        console.debug(\"Clicked collapse.\");\n        if (document.body.classList.contains(\"collapsed-site-navigation\")) {\n            document.body.classList.remove(\"collapsed-site-navigation\");\n            document.body.classList.add(\"expanded-site-navigation\");\n            container.setAttribute(\"aria-hidden\", \"false\");\n            localStorage.setItem(\"collapsed\", \"false\");\n        }\n        else {\n            document.body.classList.remove(\"expanded-site-navigation\");\n            document.body.classList.add(\"collapsed-site-navigation\");\n            container.setAttribute(\"aria-hidden\", \"true\");\n            localStorage.setItem(\"collapsed\", \"true\");\n        }\n        document.body.classList.add(\"animated\");\n    });\n}\n////////////////////////////////////////////////////////////////////////////////\n// Main entrypoint\n////////////////////////////////////////////////////////////////////////////////\nfunction main() {\n    document.documentElement.classList.remove(\"no-js\");\n    setupSidebarCollapse();\n    setupTheme();\n    setupScrollHandler();\n    // This is disabled, since we don't have inline search presentation.\n    // Without that, this just looks a bit weird.\n    // setupHeaderSearch();\n}\ndocument.addEventListener(\"DOMContentLoaded\", main);\n","import debounceAnimationFrame from \"debounce-animation-frame\";\nexport class ScrollObserver {\n    constructor(back_to_top_offset = 64, show_page_title_offset = 128) {\n        this.lastScrollTop = window.scrollY || document.documentElement.scrollTop;\n        this.back_to_top_offset = back_to_top_offset;\n        this.show_page_title_offset = show_page_title_offset;\n        this.links = Array.from(document.querySelectorAll(\".toc-container ul a[href^='#']:not([href='#'])\"));\n        this.sections = Array.from(document.getElementsByTagName(\"section\"));\n    }\n    observe() {\n        window.addEventListener(\"scroll\", debounceAnimationFrame(this.callback.bind(this)), { passive: true });\n        // Trigger it once, to populate the initial state.\n        this.callback();\n    }\n    callback() {\n        const position = window.scrollY || document.documentElement.scrollTop;\n        this.updateActiveTocAnchor(position);\n        this.updatePageTitleAndBackToTop(position);\n        this.lastScrollTop = position;\n    }\n    updateActiveTocAnchor(position) {\n        var _a;\n        const content = document.getElementById(\"lutra-main-content\");\n        const sectionMargin = content.offsetTop;\n        // Clear existing links.\n        this.links.forEach((anchor) => {\n            anchor.classList.remove(\"previous\");\n            anchor.classList.remove(\"current\");\n        });\n        // Locate the first section (from the end) that is visible.\n        let current = [...this.sections].reverse().find((section) => {\n            return position >= section.offsetTop - sectionMargin;\n        });\n        if (current === undefined) {\n            // console.debug(\"[ScrollObserver] No relevant section is visible.\");\n            return;\n        }\n        const currentLinkIndex = this.links.findIndex((anchor) => {\n            return anchor.hash === `#${current === null || current === void 0 ? void 0 : current.id}`;\n        });\n        if (currentLinkIndex === -1) {\n            // console.debug(\"[ScrollObserver] No link found for section:\", current);\n            return;\n        }\n        // Highlight the current link and mark the previous ones.\n        // console.debug(\"[ScrollObserver] Current section:\", current);\n        // console.debug(\"[ScrollObserver] Current link index:\", currentLinkIndex);\n        (_a = this.links[currentLinkIndex]) === null || _a === void 0 ? void 0 : _a.classList.add(\"current\");\n        this.links.slice(0, currentLinkIndex).forEach((anchor) => {\n            anchor.classList.add(\"previous\");\n        });\n    }\n    updatePageTitleAndBackToTop(position) {\n        if (position > this.show_page_title_offset) {\n            document.documentElement.classList.add(\"show-page-title\");\n            if (!location.hash && position < this.lastScrollTop) {\n                document.documentElement.classList.add(\"show-back-to-top\");\n            }\n            else if (position > this.lastScrollTop) {\n                document.documentElement.classList.remove(\"show-back-to-top\");\n            }\n        }\n        else {\n            document.documentElement.classList.remove(\"show-page-title\");\n        }\n        if (position < this.back_to_top_offset) {\n            document.documentElement.classList.remove(\"show-back-to-top\");\n        }\n    }\n}\n"],"names":["Object","defineProperty","exports","value","fn","timeout","args","cancelAnimationFrame","Promise","resolve","requestAnimationFrame","result","__importDefault","this","mod","__esModule","debounceAnimationFrame_1","default","mouseoverTimer","lastTouchTimestamp","prefetches","Set","prefetchElement","document","createElement","isSupported","relList","supports","window","IntersectionObserver","IntersectionObserverEntry","prototype","allowQueryString","body","dataset","allowExternalLinks","useWhitelist","mousedownShortcut","delayOnHover","useMousedown","useMousedownOnly","useViewport","intensity","instantIntensity","substr","length","navigator","connection","saveData","effectiveType","includes","documentElement","clientWidth","clientHeight","milliseconds","parseInt","isNaN","eventListenersOptions","capture","passive","addEventListener","event","performance","now","linkElement","target","closest","isPreloadable","preload","href","mouseoutListener","setTimeout","undefined","which","metaKey","ctrlKey","detail","preventDefault","once","customEvent","MouseEvent","view","bubbles","cancelable","dispatchEvent","triggeringFunction","requestIdleCallback","callback","intersectionObserver","entries","forEach","entry","isIntersecting","unobserve","querySelectorAll","observe","relatedTarget","clearTimeout","origin","location","protocol","search","hash","pathname","url","has","prefetcher","rel","head","appendChild","add","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","call","n","getter","d","a","definition","key","o","enumerable","get","obj","prop","hasOwnProperty","Theme","ScrollObserver","constructor","back_to_top_offset","show_page_title_offset","lastScrollTop","scrollY","scrollTop","links","Array","from","sections","getElementsByTagName","bind","position","updateActiveTocAnchor","updatePageTitleAndBackToTop","_a","sectionMargin","getElementById","offsetTop","anchor","classList","remove","current","reverse","find","section","currentLinkIndex","findIndex","id","slice","setTheme","mode","class_to_set","values","console","error","AUTO","LIGHT","DARK","theme","localStorage","setItem","debug","cycleThemeOnce","currentTheme","getItem","matchMedia","matches","button","container","contains","setAttribute","setupSidebarCollapse","buttons","getElementsByClassName","btn","e","setupTheme"],"sourceRoot":""}